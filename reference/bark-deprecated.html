<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NonParametric Regression using Bayesian Additive Regression Kernels — bark-deprecated • bark</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="NonParametric Regression using Bayesian Additive Regression Kernels — bark-deprecated"><meta property="og:description" content="BARK is a Bayesian sum-of-kernels model.
For numeric response \(y\), we have
\(y = f(x) + \epsilon\),
where \(\epsilon \sim N(0,\sigma^2)\).
For a binary response \(y\), \(P(Y=1 | x) = F(f(x))\),
where \(F\)
denotes the standard normal cdf (probit link).

In both cases, \(f\) is the sum of many Gaussian kernel functions.
The goal is to have very flexible inference for the unknown
function \(f\).
BARK uses an approximation to a Cauchy process as the prior distribution
for the unknown function \(f\).
Feature selection can be achieved through the inference
on the scale parameters in the Gaussian kernels.
BARK accepts four different types of prior distributions,
e, d, enabling
either soft shrinkage or  se, sd, enabling hard shrinkage for the scale
parameters."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bark</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/bark.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/merliseclyde/bark/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>NonParametric Regression using Bayesian Additive Regression Kernels</h1>
    <small class="dont-index">Source: <a href="https://github.com/merliseclyde/bark/blob/HEAD/R/depr_bark.r" class="external-link"><code>R/depr_bark.r</code></a></small>
    <div class="hidden name"><code>bark-deprecated.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>BARK is a Bayesian <em>sum-of-kernels</em> model.<br>
For numeric response \(y\), we have
\(y = f(x) + \epsilon\),
where \(\epsilon \sim N(0,\sigma^2)\).<br>
For a binary response \(y\), \(P(Y=1 | x) = F(f(x))\),
where \(F\)
denotes the standard normal cdf (probit link).
<br>
In both cases, \(f\) is the sum of many Gaussian kernel functions.
The goal is to have very flexible inference for the unknown
function \(f\).
BARK uses an approximation to a Cauchy process as the prior distribution
for the unknown function \(f\).</p>
<p>Feature selection can be achieved through the inference
on the scale parameters in the Gaussian kernels.
BARK accepts four different types of prior distributions,
<em>e</em>, <em>d</em>, enabling
either soft shrinkage or  <em>se</em>, <em>sd</em>, enabling hard shrinkage for the scale
parameters.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x.train</dt>
<dd><p>Explanatory variables for training (in sample) data.<br>
Must be a matrix of doubles,
with (as usual) rows corresponding to observations
and columns to variables.</p></dd>


<dt>y.train</dt>
<dd><p>Dependent variable for training (in sample) data.<br>
If y is numeric a continuous response model is fit (normal errors).<br>
If y is a logical (or just has values 0 and 1),
then a binary response model with a probit link is fit.</p></dd>


<dt>x.test</dt>
<dd><p>Explanatory variables for test (out of sample) data.<br>
Should have same structure as x.train.</p></dd>


<dt>type</dt>
<dd><p>BARK type, <em>e</em>, <em>d</em>, <em>se</em>, or <em>sd</em>, default
choice is <em>se</em>.<br><em>e</em>: BARK with equal weights.<br><em>d</em>: BARK with different weights.<br><em>se</em>: BARK with selection and equal weights.<br><em>sd</em>: BARK with selection and different weights.<br></p></dd>


<dt>classification</dt>
<dd><p>TRUE/FALSE logical variable,
indicating a classification or regression problem.</p></dd>


<dt>keepevery</dt>
<dd><p>Every keepevery draw is kept to be returned to the user</p></dd>


<dt>nburn</dt>
<dd><p>Number of MCMC iterations (nburn*keepevery)
to be treated as burn in.</p></dd>


<dt>nkeep</dt>
<dd><p>Number of MCMC iterations kept for the posterior inference.<br>
nkeep*keepevery iterations after the burn in.</p></dd>


<dt>printevery</dt>
<dd><p>As the MCMC runs, a message is printed every printevery draws.</p></dd>


<dt>keeptrain</dt>
<dd><p>Logical, whether to keep results for training samples.</p></dd>


<dt>fixed</dt>
<dd><p>A list of fixed hyperparameters, using the default values if not
specified.<br>
alpha = 1: stable index, must be 1 currently.<br>
eps = 0.5: approximation parameter.<br>
gam = 5: intensity parameter.<br>
la = 1: first argument of the gamma prior on kernel scales.<br>
lb = 2: second argument of the gamma prior on kernel scales.<br>
pbetaa = 1: first argument of the beta prior on plambda.<br>
pbetab = 1: second argument of the beta prior on plambda.<br>
n: number of training samples, automatically generates.<br>
p: number of explanatory variables, automatically generates.<br>
meanJ: the expected number of kernels, automatically generates.</p></dd>


<dt>tune</dt>
<dd><p>A list of tuning parameters, not expected to change.<br>
lstep: the stepsize of the lognormal random walk on lambda.<br>
frequL: the frequency to update L.<br>
dpow: the power on the death step.<br>
upow: the power on the update step.<br>
varphistep: the stepsize of the lognormal random walk on varphi.<br>
phistep: the stepsize of the lognormal random walk on phi.</p></dd>


<dt>theta</dt>
<dd><p>A list of the starting values for the parameter theta,
use defaults if nothing is given.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>bark</code> returns a list, including:</p>
<dl><dt>fixed</dt>
<dd><p>Fixed hyperparameters</p></dd>

 <dt>tune</dt>
<dd><p>Tuning parameters used</p></dd>

 <dt>theta.last</dt>
<dd><p>The last set of parameters from the posterior draw</p></dd>

 <dt>theta.nvec</dt>
<dd><p>A matrix with nrow(x.train)\(+1\) rows and (nkeep) columns,
recording the  number of kernels at each training sample</p></dd>

 <dt>theta.varphi</dt>
<dd><p>A matrix with nrow(x.train)
 \(+1\) rows and (nkeep) columns,
 recording the precision in the normal gamma prior
 distribution for the regression coefficients</p></dd>

 <dt>theta.beta</dt>
<dd><p>A matrix with nrow(x.train)\(+1\) rows and (nkeep) columns,
 recording the regression coefficients</p></dd>

 <dt>theta.lambda</dt>
<dd><p>A matrix with ncol(x.train) rows and (nkeep) columns,
  recording the kernel scale parameters</p></dd>

 <dt>thea.phi</dt>
<dd><p>The vector of length nkeep,
 recording the precision in regression Gaussian noise
 (1 for the classification case)</p></dd>

 <dt>yhat.train</dt>
<dd><p>A matrix with nrow(x.train) rows and (nkeep) columns.
 Each column corresponds to a draw \(f^*\) from
 the posterior of \(f\)
  and each row corresponds to a row of x.train.
 The \((i,j)\) value is \(f^*(x)\) for
 the \(j^{th}\) kept draw of \(f\)
 and the \(i^{th}\) row of x.train.<br>
 For classification problems, this is the value
 of the expectation for the underlying normal
 random variable.<br>
 Burn-in is dropped</p></dd>

<dt>yhat.test</dt>
<dd><p>Same as yhat.train but now the x's
are the rows of the test data</p></dd>

<dt>yhat.train.mean</dt>
<dd><p>train data fits = row mean of yhat.train</p></dd>

<dt>yhat.test.mean</dt>
<dd><p>test data fits = row mean of yhat.test</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>BARK is implemented using a Bayesian MCMC method.
At each MCMC interaction, we produce a draw from the joint posterior
distribution, i.e. a full configuration of regression coefficients,
kernel locations and kernel parameters etc.</p>
<p>Thus, unlike a lot of other modelling methods in R,
we do not produce a single model object
from which fits and summaries may be extracted.
The output consists of values
\(f^*(x)\) (and \(\sigma^*\) in the numeric case)
where * denotes a particular draw.
The \(x\) is either a row from the training data (x.train)</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ouyang, Zhi (2008) Bayesian Additive Regression Kernels.
Duke University. PhD dissertation, page 58.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other bark deprecated functions: 
<code><a href="bark-package-deprecated.html">bark-package-deprecated</a></code>,
<code><a href="sim.Circle-deprecated.html">sim.Circle-deprecated</a></code>,
<code><a href="sim.Friedman1-deprecated.html">sim.Friedman1-deprecated</a></code>,
<code><a href="sim.Friedman2-deprecated.html">sim.Friedman2-deprecated</a></code>,
<code><a href="sim.Friedman3-deprecated.html">sim.Friedman3-deprecated</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##Simulate regression example</span></span></span>
<span class="r-in"><span><span class="co"># Friedman 2 data set, 200 noisy training, 1000 noise free testing</span></span></span>
<span class="r-in"><span><span class="co"># Out of sample MSE in SVM (default RBF): 6500 (sd. 1600)</span></span></span>
<span class="r-in"><span><span class="co"># Out of sample MSE in BART (default):    5300 (sd. 1000)</span></span></span>
<span class="r-in"><span><span class="va">traindata</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_Friedman2.html">sim_Friedman2</a></span><span class="op">(</span><span class="fl">200</span>, sd<span class="op">=</span><span class="fl">125</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_Friedman2.html">sim_Friedman2</a></span><span class="op">(</span><span class="fl">1000</span>, sd<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.bark.d</span> <span class="op">&lt;-</span> <span class="fu"><a href="bark-package-deprecated.html">bark_mat</a></span><span class="op">(</span><span class="va">traindata</span><span class="op">$</span><span class="va">x</span>, <span class="va">traindata</span><span class="op">$</span><span class="va">y</span>, <span class="va">testdata</span><span class="op">$</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>                  nburn<span class="op">=</span><span class="fl">10</span>, nkeep<span class="op">=</span><span class="fl">100</span>, keepevery<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>                  classification<span class="op">=</span><span class="cn">FALSE</span>, type<span class="op">=</span><span class="st">"d"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Starting BARK-d for this regression problem"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "posterior mcmc iteration 1000, J=5, max(nj)=1"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">fit.bark.d</span><span class="op">$</span><span class="va">theta.lambda</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bark-deprecated-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">fit.bark.d</span><span class="op">$</span><span class="va">yhat.test.mean</span><span class="op">-</span><span class="va">testdata</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3717.933</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="co">##Simulate classification example</span></span></span>
<span class="r-in"><span> <span class="co"># Circle 5 with 2 signals and three noisy dimensions</span></span></span>
<span class="r-in"><span> <span class="co"># Out of sample erorr rate in SVM (default RBF): 0.110 (sd. 0.02)</span></span></span>
<span class="r-in"><span> <span class="co"># Out of sample error rate in BART (default):    0.065 (sd. 0.02)</span></span></span>
<span class="r-in"><span> <span class="va">traindata</span> <span class="op">&lt;-</span> <span class="fu">sim_Circle</span><span class="op">(</span><span class="fl">200</span>, dim<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu">sim_Circle</span><span class="op">(</span><span class="fl">1000</span>, dim<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">fit.bark.se</span> <span class="op">&lt;-</span> <span class="fu"><a href="bark-package-deprecated.html">bark_mat</a></span><span class="op">(</span><span class="va">traindata</span><span class="op">$</span><span class="va">x</span>, <span class="va">traindata</span><span class="op">$</span><span class="va">y</span>, <span class="va">testdata</span><span class="op">$</span><span class="va">x</span>, classification<span class="op">=</span><span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"se"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">fit.bark.se</span><span class="op">$</span><span class="va">theta.lambda</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">fit.bark.se</span><span class="op">$</span><span class="va">yhat.test.mean</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">!=</span><span class="va">testdata</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Merlise Clyde, Zhi Ouyang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

